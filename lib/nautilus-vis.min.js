!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("nautilus-vis",[],t):"object"==typeof exports?exports["nautilus-vis"]=t():e["nautilus-vis"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=n||{};n.getTransitionTimePerYear=function(e,t){console.log(e);for(var r={},n=(t=void 0!==t?t:4e3,d3.scale.threshold().domain([1,3,10,20,30]).range([300,.2*t,.5*t,.7*t,.85*t,t])),a=e.graph.yearRange,i=a[0];i<=a[1];i++)r[i]=n(e.graph.nodeCountsPerYear[i]);return r},n.yearTickClickEventListener=function(){d3.selectAll(".yearTick").on("click",function(e){var t=this.getAttribute("data-year");d3.selectAll(".node, .link").transition().duration(0),n.egoGraphVis.newDestinationNode(t)})};var a=function(){"ABORT"!==citationvis_data&&(d3.select("#mainDiv").append("p").attr("class","loadingText").text("Loading..."),d3.json(citationvis_data,function(e,t){if(console.log(e),e)throw $(".loadingText").html('There was an error generating the visualization, or else data processing is still in progress. Try reloading the page later, or generating the visualization again. If the problem persists, <a href="mailto:jporteno@uw.edu">contact the administrator</a>.').css({color:"red"}),e;var r=d3.nest().key(function(e){return e.DomainID}).sortValues(d3.descending).rollup(function(e){return e.length}).entries(t.nodes[0].papers);r.sort(function(e,t){return d3.descending(e.values,t.values)}),t.nodes[0].DomainCounts=r,console.log(t);var a=n.default_options,i=n.summaryStatistics,o=n.egoGraphData,s=n.lineChartData,l=(n.eventListeners,a.defaults);console.log(l),t=i.addSummaryStatistics(t),n.graph_data=o.prepare_egoGraphData(t),n.publications_data=s.prepareData_egoAuthorPublications(t),n.all_citations_data=s.prepareData_allCitations(t),n.eigenfactor_sum_data=s.prepareData_authorEigenfactorSum(t),n.egoGraphVis=new egoGraphVis(n.graph_data),n.lineCharts=[],n.lineCharts.push(new lineChartByYear(n.publications_data)),n.lineCharts.push(new lineChartByYear(n.all_citations_data)),n.lineCharts.push(new lineChartByYear(n.eigenfactor_sum_data)),l.transitionTimePerYear=n.getTransitionTimePerYear(t),n.egoGraphVis.importDefaultOptions(l);for(var u=0;u<n.lineCharts.length;u++)n.lineCharts[u].importDefaultOptions(l);for(n.egoGraphVis.init(),u=0;u<n.lineCharts.length;u++)n.lineCharts[u].init();$.event.trigger({type:"initComplete"}),n.lineCharts[0].addTitle("Number of publications"),n.lineCharts[1].addTitle("Number of citations received");var c=function(e){for(var t=window.location.search.substring(1).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");if(n[0]==e)return n[1]}return!1}("ctrtype");c||(c="author"),console.log(c),n.lineCharts[2].addTitle("Sum of eigenfactor for this "+c+"'s publications by year"),$(document).on("yearChange",function(){for(var e=n.egoGraphVis.currYear,t=0;t<n.lineCharts.length;t++)n.lineCharts[t].moveYearIndicator(e)}),d3.select(n.lineCharts[0].chartDiv[0][0]).select(".y.axis").select(".axisLabel").text("Num publications"),n.lineCharts[2].yAxis.tickFormat(d3.format("e")),d3.select(n.lineCharts[2].chartDiv[0][0]).select(".y.axis").call(n.lineCharts[2].yAxis).select(".axisLabel").text("Sum of Eigenfactor"),n.yearTickClickEventListener(),d3.select(".loadingText").remove()}))};r.d(t,"main",function(){return a})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXV0aWx1cy12aXMvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL25hdXRpbHVzLXZpcy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9uYXV0aWx1cy12aXMvLi9zcmMvY2l0YXRpb25WaXNfTWFpbi5qcyIsIndlYnBhY2s6Ly9uYXV0aWx1cy12aXMvLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY2l0YXRpb25WaXMiLCJnZXRUcmFuc2l0aW9uVGltZVBlclllYXIiLCJncmFwaCIsImxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUiLCJjb25zb2xlIiwibG9nIiwidHJhbnNpdGlvblRpbWVQZXJZZWFyIiwidGhyZXNob2xkU2NhbGUiLCJkMyIsInNjYWxlIiwidGhyZXNob2xkIiwiZG9tYWluIiwicmFuZ2UiLCJ5ZWFyUmFuZ2UiLCJub2RlQ291bnRzUGVyWWVhciIsInllYXJUaWNrQ2xpY2tFdmVudExpc3RlbmVyIiwic2VsZWN0QWxsIiwib24iLCJkZXN0aW5hdGlvblllYXIiLCJnZXRBdHRyaWJ1dGUiLCJ0cmFuc2l0aW9uIiwiZHVyYXRpb24iLCJlZ29HcmFwaFZpcyIsIm5ld0Rlc3RpbmF0aW9uTm9kZSIsIm1haW4iLCJjaXRhdGlvbnZpc19kYXRhIiwic2VsZWN0IiwiYXBwZW5kIiwiYXR0ciIsInRleHQiLCJqc29uIiwiZXJyb3IiLCIkIiwiaHRtbCIsImNzcyIsImNvbG9yIiwiZG9tYWluc05lc3QiLCJuZXN0IiwiRG9tYWluSUQiLCJzb3J0VmFsdWVzIiwiZGVzY2VuZGluZyIsInJvbGx1cCIsImxlYXZlcyIsImxlbmd0aCIsImVudHJpZXMiLCJub2RlcyIsInBhcGVycyIsInNvcnQiLCJhIiwiYiIsInZhbHVlcyIsIkRvbWFpbkNvdW50cyIsImRlZmF1bHRfb3B0aW9ucyIsInN1bW1hcnlTdGF0aXN0aWNzIiwiZWdvR3JhcGhEYXRhIiwibGluZUNoYXJ0RGF0YSIsIm9wdGlvbnMiLCJldmVudExpc3RlbmVycyIsImRlZmF1bHRzIiwiYWRkU3VtbWFyeVN0YXRpc3RpY3MiLCJncmFwaF9kYXRhIiwicHJlcGFyZV9lZ29HcmFwaERhdGEiLCJwdWJsaWNhdGlvbnNfZGF0YSIsInByZXBhcmVEYXRhX2Vnb0F1dGhvclB1YmxpY2F0aW9ucyIsImFsbF9jaXRhdGlvbnNfZGF0YSIsInByZXBhcmVEYXRhX2FsbENpdGF0aW9ucyIsImVpZ2VuZmFjdG9yX3N1bV9kYXRhIiwicHJlcGFyZURhdGFfYXV0aG9yRWlnZW5mYWN0b3JTdW0iLCJsaW5lQ2hhcnRzIiwicHVzaCIsImxpbmVDaGFydEJ5WWVhciIsImltcG9ydERlZmF1bHRPcHRpb25zIiwiaW5pdCIsImV2ZW50IiwidHJpZ2dlciIsInR5cGUiLCJhZGRUaXRsZSIsImN0cnR5cGUiLCJ2YXJpYWJsZSIsInZhcnMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInNwbGl0IiwicGFpciIsImdldFF1ZXJ5VmFyaWFibGUiLCJkb2N1bWVudCIsImN1cnJZZWFyIiwibW92ZVllYXJJbmRpY2F0b3IiLCJjaGFydERpdiIsInlBeGlzIiwidGlja0Zvcm1hdCIsImZv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QyxFQUFVLDJCQUc5RTdDLEVBQUd1RCxVQUFXdEUsR0FBSSxhQUFjLFdBRS9CLElBREEsSUFBSXVFLEVBQVd4RixFQUFZc0IsWUFBWWtFLFNBQzlCeEgsRUFBRSxFQUFHQSxFQUFFZ0MsRUFBWW9FLFdBQVd6QixPQUFRM0UsSUFDOUNnQyxFQUFZb0UsV0FBV3BHLEdBQUd5SCxrQkFBa0JELEtBTW5DaEYsR0FBR2tCLE9BQU8xQixFQUFZb0UsV0FBVyxHQUFHc0IsU0FBUyxHQUFHLElBQ2xDaEUsT0FBTyxXQUFXQSxPQUFPLGNBQ3BDRyxLQUFLLG9CQUduQjdCLEVBQVlvRSxXQUFXLEdBQUd1QixNQUFNQyxXQUFXcEYsR0FBR3FGLE9BQU8sTUFFdkNyRixHQUFHa0IsT0FBTzFCLEVBQVlvRSxXQUFXLEdBQUdzQixTQUFTLEdBQUcsSUFDdERoRSxPQUFPLFdBRWJ2RCxLQUFLNkIsRUFBWW9FLFdBQVcsR0FBR3VCLE9BQy9CakUsT0FBTyxjQUFjRyxLQUFLLHNCQUs1QjdCLEVBQVllLDZCQUVaUCxHQUFHa0IsT0FBTyxnQkFBZ0JvRSxhQzNLM0JoSSxFQUFBUSxFQUFBeUgsRUFBQSx5QkFBQUMiLCJmaWxlIjoibmF1dGlsdXMtdmlzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwibmF1dGlsdXMtdmlzXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIm5hdXRpbHVzLXZpc1wiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJuYXV0aWx1cy12aXNcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiLy8gaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS9zbmlwcGV0cy9qYXZhc2NyaXB0L2dldC11cmwtdmFyaWFibGVzL1xuZnVuY3Rpb24gZ2V0UXVlcnlWYXJpYWJsZSh2YXJpYWJsZSlcbntcbiAgICB2YXIgcXVlcnkgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKTtcbiAgICB2YXIgdmFycyA9IHF1ZXJ5LnNwbGl0KFwiJlwiKTtcbiAgICBmb3IgKHZhciBpPTA7IGk8dmFycy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcGFpciA9IHZhcnNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICBpZihwYWlyWzBdID09IHZhcmlhYmxlKSB7cmV0dXJuIHBhaXJbMV07fVxuICAgIH1cbiAgICByZXR1cm4oZmFsc2UpO1xufVxuXG5cbi8vIGNpdGF0aW9udmlzX2RhdGEgaXMgYSB2YXJpYWJsZSBkZWZpbmVkIGluIHRoZSBmbGFzayB0ZW1wbGF0ZSB0aGF0IGluY2x1ZGVzIHRoaXMganMgZmlsZSAoZS5nLiB2aXNtYWluLmh0bWwpXG5cbnZhciBjaXRhdGlvblZpcyA9IGNpdGF0aW9uVmlzIHx8IHt9O1xuXG5jaXRhdGlvblZpcy5nZXRUcmFuc2l0aW9uVGltZVBlclllYXI9IGZ1bmN0aW9uKGdyYXBoLCBsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lKSB7XG5cdGNvbnNvbGUubG9nKGdyYXBoKTtcblx0Ly8gVGhpcyB3aWxsIGxldCB1cyB2YXJ5IHRoZSB0cmFuc2l0aW9uIHRpbWUgcGVyIHllYXJcblx0dmFyIHRyYW5zaXRpb25UaW1lUGVyWWVhciA9IHt9O1xuXHR2YXIgZW1wdHlZZWFyVHJhbnNpdGlvblRpbWUgPSAzMDA7XG5cdC8vIHZhciBsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lID0gNDAwMDtcblx0Ly8gU2V0IGRlZmF1bHQgdmFsdWU6XG5cdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvODk0ODYwL3NldC1hLWRlZmF1bHQtcGFyYW1ldGVyLXZhbHVlLWZvci1hLWphdmFzY3JpcHQtZnVuY3Rpb25cblx0dmFyIGxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUgPSB0eXBlb2YgbG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSAhPT0gJ3VuZGVmaW5lZCcgPyBsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lIDogNDAwMDtcblx0Ly8gVGhpcyBzY2FsZSB0YWtlcyB0aGUgbnVtYmVyIG9mIG5vZGVzIGZvciBhIGdpdmVuIHllYXIgYXMgaW5wdXRcblx0Ly8gYW5kIG91dHB1dHMgdGhlIHRyYW5zaXRpb24gdGltZSwgYmFzZWQgb24gYSB0aHJlc2hvbGQgbWFwcGluZ1xuXHR2YXIgdGhyZXNob2xkU2NhbGUgPSBkMy5zY2FsZS50aHJlc2hvbGQoKVxuXHRcdC5kb21haW4oWzEsIDMsIDEwLCAyMCwgMzBdKVxuXHRcdC5yYW5nZShbXG5cdFx0XHRcdGVtcHR5WWVhclRyYW5zaXRpb25UaW1lLCAgLy8gemVybyBub2Rlc1xuXHRcdFx0XHRsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lICogLjIsICAvLyBvbmUgb3IgdHdvIG5vZGVzXG5cdFx0XHRcdGxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUgKiAuNSwgLy8gMyB0byA5XG5cdFx0XHRcdGxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUgKiAuNywgIC8vIDEwIHRvIDE5XG5cdFx0XHRcdGxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUgKiAuODUsICAvLyAyMCB0byAyOVxuXHRcdFx0XHRsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lICAvLyAzMCtcblx0XHRcdFx0XSk7XG5cdHZhciB5ZWFyUmFuZ2UgPSBncmFwaC5ncmFwaC55ZWFyUmFuZ2U7XG5cdFxuXHQvLyBQdXQgdGhlIHRyYW5zaXRpb24gdGltZSBmb3IgZWFjaCB5ZWFyIGludG8gYW4gb2JqZWN0XG5cdGZvciAodmFyIGk9eWVhclJhbmdlWzBdOyBpPD15ZWFyUmFuZ2VbMV07IGkrKykge1xuXHRcdC8vIHRyYW5zaXRpb25UaW1lUGVyWWVhcltpXSA9IDEwMDA7XG5cdFx0dHJhbnNpdGlvblRpbWVQZXJZZWFyW2ldID0gdGhyZXNob2xkU2NhbGUoZ3JhcGguZ3JhcGgubm9kZUNvdW50c1BlclllYXJbaV0pO1xuXHR9XG5cdHJldHVybiB0cmFuc2l0aW9uVGltZVBlclllYXI7XG59O1xuXG5jaXRhdGlvblZpcy55ZWFyVGlja0NsaWNrRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIEFkZCBjbGljayBsaXN0ZW5lcnMgdG8gbGluZSBjaGFydCBheGlzIHRpY2sgbGFiZWxzICh5ZWFycykuXG4gICAgLy8gT24gY2xpY2ssIGEgbmV3IGRlc3RpbmF0aW9uIG5vZGUgd2lsbCBiZSBzZXQuXG4gICAgZDMuc2VsZWN0QWxsKCcueWVhclRpY2snKVxuICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgLy8gR2V0IHRoZSB5ZWFyIChhcyBpbnRlZ2VyKVxuICAgICAgICAgICAgdmFyIGRlc3RpbmF0aW9uWWVhciA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLXllYXInKTtcbiAgICAgICAgICAgIC8vIFN0b3AgYWxsIHRyYW5zaXRpb25zIG9uIG5vZGVzIGFuZCBsaW5rc1xuICAgICAgICAgICAgZDMuc2VsZWN0QWxsKCcubm9kZSwgLmxpbmsnKS50cmFuc2l0aW9uKCkuZHVyYXRpb24oMCk7XG5cblx0XHRcdGNpdGF0aW9uVmlzLmVnb0dyYXBoVmlzLm5ld0Rlc3RpbmF0aW9uTm9kZShkZXN0aW5hdGlvblllYXIpO1xuICAgICAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIG1haW4oKSB7XG5cbmlmIChjaXRhdGlvbnZpc19kYXRhID09PSAnQUJPUlQnKSB7XG5cdHJldHVybjtcbn1cblxuZDMuc2VsZWN0KCcjbWFpbkRpdicpLmFwcGVuZCgncCcpXG5cdC5hdHRyKFwiY2xhc3NcIiwgXCJsb2FkaW5nVGV4dFwiKVxuXHQudGV4dCgnTG9hZGluZy4uLicpO1xuXG5kMy5qc29uKGNpdGF0aW9udmlzX2RhdGEsIGZ1bmN0aW9uKGVycm9yLCBncmFwaCkge1xuXHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdGlmIChlcnJvcikge1xuXHRcdHZhciBjb250YWN0RW1haWwgPSAnanBvcnRlbm9AdXcuZWR1Jztcblx0XHR2YXIgZXJySHRtbCA9ICdUaGVyZSB3YXMgYW4gZXJyb3IgZ2VuZXJhdGluZyB0aGUgdmlzdWFsaXphdGlvbiwgb3IgZWxzZSBkYXRhIHByb2Nlc3NpbmcgaXMgc3RpbGwgaW4gcHJvZ3Jlc3MuIFRyeSByZWxvYWRpbmcgdGhlIHBhZ2UgbGF0ZXIsIG9yIGdlbmVyYXRpbmcgdGhlIHZpc3VhbGl6YXRpb24gYWdhaW4uIElmIHRoZSBwcm9ibGVtIHBlcnNpc3RzLCA8YSBocmVmPVwibWFpbHRvOicgKyBjb250YWN0RW1haWwgKyAnXCI+Y29udGFjdCB0aGUgYWRtaW5pc3RyYXRvcjwvYT4uJ1xuXHRcdCQoICcubG9hZGluZ1RleHQnICkuaHRtbCggZXJySHRtbCApXG5cdFx0XHQuY3NzKCB7J2NvbG9yJzogJ3JlZCd9ICk7XG5cdFx0dGhyb3cgZXJyb3I7XG5cdH1cblxuXHQvLyBHZXQgdGhlIG1vc3QgY29tbW9uIERvbWFpbiBJRHMgZm9yIHRoZSBlZ28gYXV0aG9yJ3MgcGFwZXJzXG5cdHZhciBkb21haW5zTmVzdCA9IGQzLm5lc3QoKVxuXHRcdC5rZXkoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5Eb21haW5JRDsgfSkuc29ydFZhbHVlcyhkMy5kZXNjZW5kaW5nKVxuXHRcdC5yb2xsdXAoZnVuY3Rpb24obGVhdmVzKSB7IHJldHVybiBsZWF2ZXMubGVuZ3RoOyB9KVxuXHRcdC5lbnRyaWVzKGdyYXBoLm5vZGVzWzBdLnBhcGVycyk7XG5cdGRvbWFpbnNOZXN0LnNvcnQoZnVuY3Rpb24oYSxiKSB7IHJldHVybiBkMy5kZXNjZW5kaW5nKGEudmFsdWVzLCBiLnZhbHVlcyk7IH0pO1xuXHQvLyBzdG9yZSBhcyBhIG5vZGUgcHJvcGVydHlcblx0Z3JhcGgubm9kZXNbMF0uRG9tYWluQ291bnRzID0gZG9tYWluc05lc3Q7XG5cdGNvbnNvbGUubG9nKGdyYXBoKTtcblx0Ly8gZDMuc2VsZWN0KCcjaW5mb0RpdicpLmFwcGVuZCgncCcpLnRleHQoZ3JhcGgubm9kZXNbMF0uQXV0aG9yTmFtZSk7XG5cblx0dmFyIGRlZmF1bHRfb3B0aW9ucyA9IGNpdGF0aW9uVmlzLmRlZmF1bHRfb3B0aW9ucywgXG5cdFx0c3VtbWFyeVN0YXRpc3RpY3MgPSBjaXRhdGlvblZpcy5zdW1tYXJ5U3RhdGlzdGljcyxcblx0XHRlZ29HcmFwaERhdGEgPSBjaXRhdGlvblZpcy5lZ29HcmFwaERhdGEsXG5cdCAgICBsaW5lQ2hhcnREYXRhID0gY2l0YXRpb25WaXMubGluZUNoYXJ0RGF0YSxcblx0XHRldmVudExpc3RlbmVycyA9IGNpdGF0aW9uVmlzLmV2ZW50TGlzdGVuZXJzO1xuXG5cdHZhciBvcHRpb25zID0gZGVmYXVsdF9vcHRpb25zLmRlZmF1bHRzO1xuXHRjb25zb2xlLmxvZyhvcHRpb25zKTtcblxuXHRncmFwaCA9IHN1bW1hcnlTdGF0aXN0aWNzLmFkZFN1bW1hcnlTdGF0aXN0aWNzKGdyYXBoKTtcblx0Y2l0YXRpb25WaXMuZ3JhcGhfZGF0YSA9IGVnb0dyYXBoRGF0YS5wcmVwYXJlX2Vnb0dyYXBoRGF0YShncmFwaCk7XG5cdGNpdGF0aW9uVmlzLnB1YmxpY2F0aW9uc19kYXRhID0gbGluZUNoYXJ0RGF0YS5wcmVwYXJlRGF0YV9lZ29BdXRob3JQdWJsaWNhdGlvbnMoZ3JhcGgpO1xuXHRjaXRhdGlvblZpcy5hbGxfY2l0YXRpb25zX2RhdGEgPSBsaW5lQ2hhcnREYXRhLnByZXBhcmVEYXRhX2FsbENpdGF0aW9ucyhncmFwaCk7XG5cdGNpdGF0aW9uVmlzLmVpZ2VuZmFjdG9yX3N1bV9kYXRhID0gbGluZUNoYXJ0RGF0YS5wcmVwYXJlRGF0YV9hdXRob3JFaWdlbmZhY3RvclN1bShncmFwaCk7XG5cblx0Ly8gVmlzdWFsaXphdGlvbiBvYmplY3RzIGdvIGhlcmVcblx0Y2l0YXRpb25WaXMuZWdvR3JhcGhWaXMgPSBuZXcgZWdvR3JhcGhWaXMoY2l0YXRpb25WaXMuZ3JhcGhfZGF0YSk7XG5cdC8vIGNpdGF0aW9uVmlzLnB1YmxpY2F0aW9uc0xpbmVDaGFydCA9IG5ldyBsaW5lQ2hhcnRCeVllYXIoY2l0YXRpb25WaXMucHVibGljYXRpb25zX2RhdGEpO1xuXHQvLyBjaXRhdGlvblZpcy5jaXRhdGlvbnNMaW5lQ2hhcnQgPSBuZXcgbGluZUNoYXJ0QnlZZWFyKGNpdGF0aW9uVmlzLmFsbF9jaXRhdGlvbnNfZGF0YSk7XG5cdC8vIGNpdGF0aW9uVmlzLmVpZ2VuZmFjdG9yU3VtTGluZUNoYXJ0ID0gbmV3IGxpbmVDaGFydEJ5WWVhcihjaXRhdGlvblZpcy5laWdlbmZhY3Rvcl9zdW1fZGF0YSk7XG5cdGNpdGF0aW9uVmlzLmxpbmVDaGFydHMgPSBbXTtcblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0cy5wdXNoKG5ldyBsaW5lQ2hhcnRCeVllYXIoY2l0YXRpb25WaXMucHVibGljYXRpb25zX2RhdGEpKTtcblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0cy5wdXNoKG5ldyBsaW5lQ2hhcnRCeVllYXIoY2l0YXRpb25WaXMuYWxsX2NpdGF0aW9uc19kYXRhKSk7XG5cdGNpdGF0aW9uVmlzLmxpbmVDaGFydHMucHVzaChuZXcgbGluZUNoYXJ0QnlZZWFyKGNpdGF0aW9uVmlzLmVpZ2VuZmFjdG9yX3N1bV9kYXRhKSk7XG5cblx0b3B0aW9ucy50cmFuc2l0aW9uVGltZVBlclllYXIgPSBjaXRhdGlvblZpcy5nZXRUcmFuc2l0aW9uVGltZVBlclllYXIoZ3JhcGgpO1xuXG5cdGNpdGF0aW9uVmlzLmVnb0dyYXBoVmlzLmltcG9ydERlZmF1bHRPcHRpb25zKG9wdGlvbnMpO1xuXHRmb3IgKHZhciBpPTA7IGk8Y2l0YXRpb25WaXMubGluZUNoYXJ0cy5sZW5ndGg7IGkrKykge1xuXHRcdGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbaV0uaW1wb3J0RGVmYXVsdE9wdGlvbnMob3B0aW9ucyk7XG5cdH1cblxuXHRjaXRhdGlvblZpcy5lZ29HcmFwaFZpcy5pbml0KCk7XG5cdGZvciAodmFyIGk9MDsgaTxjaXRhdGlvblZpcy5saW5lQ2hhcnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y2l0YXRpb25WaXMubGluZUNoYXJ0c1tpXS5pbml0KCk7XG5cdH1cblx0JC5ldmVudC50cmlnZ2VyKHtcblx0XHR0eXBlOiBcImluaXRDb21wbGV0ZVwiLFxuXHR9KTtcblxuXHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzBdLmFkZFRpdGxlKFwiTnVtYmVyIG9mIHB1YmxpY2F0aW9uc1wiKTtcblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0c1sxXS5hZGRUaXRsZShcIk51bWJlciBvZiBjaXRhdGlvbnMgcmVjZWl2ZWRcIik7XG5cdHZhciBjdHJ0eXBlID0gZ2V0UXVlcnlWYXJpYWJsZShcImN0cnR5cGVcIik7XG5cdGlmICghY3RydHlwZSkge1xuXHRcdGN0cnR5cGUgPSBcImF1dGhvclwiO1xuXHR9XG5cdGNvbnNvbGUubG9nKGN0cnR5cGUpO1xuXHQvLyBjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzJdLmFkZFRpdGxlKFwiU3VtIG9mIGVpZ2VuZmFjdG9yIGZvciB0aGlzIGF1dGhvcidzIHB1YmxpY2F0aW9ucyBieSB5ZWFyXCIpO1xuXHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzJdLmFkZFRpdGxlKFwiU3VtIG9mIGVpZ2VuZmFjdG9yIGZvciB0aGlzIFwiICsgY3RydHlwZSArIFwiJ3MgcHVibGljYXRpb25zIGJ5IHllYXJcIik7XG5cblxuXHQkKCBkb2N1bWVudCApLm9uKCBcInllYXJDaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGN1cnJZZWFyID0gY2l0YXRpb25WaXMuZWdvR3JhcGhWaXMuY3VyclllYXI7XG5cdFx0Zm9yICh2YXIgaT0wOyBpPGNpdGF0aW9uVmlzLmxpbmVDaGFydHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbaV0ubW92ZVllYXJJbmRpY2F0b3IoY3VyclllYXIpO1xuXHRcdH1cblx0fSk7XG5cblx0Ly8gSGFjayB0byBsYWJlbCB0aGUgcHVibGljYXRpb25zIGxpbmUgY2hhcnQuIFRPRE86IEZpeCB0aGlzIGxhdGVyXG5cdC8vIHZhciBwdWJzID0gZDMuc2VsZWN0KGNpdGF0aW9uVmlzLnB1YmxpY2F0aW9uc0xpbmVDaGFydC5jaGFydERpdlswXVswXSk7XG5cdHZhciBwdWJzID0gZDMuc2VsZWN0KGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbMF0uY2hhcnREaXZbMF1bMF0pO1xuXHR2YXIgcHVic0F4aXNMYWJlbCA9IHB1YnMuc2VsZWN0KCcueS5heGlzJykuc2VsZWN0KCcuYXhpc0xhYmVsJyk7XG5cdHB1YnNBeGlzTGFiZWwudGV4dCgnTnVtIHB1YmxpY2F0aW9ucycpO1xuXHQvLyBIYWNrIHRvIGFsdGVyIGVpZ2VuZmFjdG9yIGxpbmUgY2hhcnQuIFRPRE86IEZpeCB0aGlzIGxhdGVyXG5cdC8vIGNpdGF0aW9uVmlzLmVpZ2VuZmFjdG9yU3VtTGluZUNoYXJ0LnlBeGlzLnRpY2tGb3JtYXQoZDMuZm9ybWF0KCdlJykpO1xuXHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzJdLnlBeGlzLnRpY2tGb3JtYXQoZDMuZm9ybWF0KCdlJykpO1xuXHQvLyB2YXIgRUZDaGFydCA9IGQzLnNlbGVjdChjaXRhdGlvblZpcy5laWdlbmZhY3RvclN1bUxpbmVDaGFydC5jaGFydERpdlswXVswXSk7XG5cdHZhciBFRkNoYXJ0ID0gZDMuc2VsZWN0KGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbMl0uY2hhcnREaXZbMF1bMF0pO1xuXHRFRkNoYXJ0LnNlbGVjdCgnLnkuYXhpcycpXG5cdFx0Ly8gLmNhbGwoY2l0YXRpb25WaXMuZWlnZW5mYWN0b3JTdW1MaW5lQ2hhcnQueUF4aXMpXG5cdFx0LmNhbGwoY2l0YXRpb25WaXMubGluZUNoYXJ0c1syXS55QXhpcylcblx0XHQuc2VsZWN0KCcuYXhpc0xhYmVsJykudGV4dCgnU3VtIG9mIEVpZ2VuZmFjdG9yJyk7XG5cblxuXHQvLyBFdmVudCBsaXN0ZW5lcnNcblx0Ly8gRXZlbnQgbGlzdGVuZXJzIHRoYXQgYWN0IGFjcm9zcyBkaWZmZXJlbnQgdmlzdWFsaXphdGlvbiBvYmplY3RzIGdvIGhlcmVcblx0Y2l0YXRpb25WaXMueWVhclRpY2tDbGlja0V2ZW50TGlzdGVuZXIoKTtcblx0XG5cdGQzLnNlbGVjdChcIi5sb2FkaW5nVGV4dFwiKS5yZW1vdmUoKTtcbn0pO1xuLy8gfSkoY2l0YXRpb252aXNfZGF0YSk7XG59XG5cbi8vIG1haW4oKTtcbi8vXG5leHBvcnQgZGVmYXVsdCBtYWluO1xuIiwiaW1wb3J0IG1haW4gZnJvbSAnLi9jaXRhdGlvblZpc19NYWluLmpzJztcbmV4cG9ydCB7IG1haW4gfTtcblxuIl0sInNvdXJjZVJvb3QiOiIifQ==