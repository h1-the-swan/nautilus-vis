!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("nautilus_vis",[],t):"object"==typeof exports?exports.nautilus_vis=t():e.nautilus_vis=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=n||{};n.getTransitionTimePerYear=function(e,t){console.log(e);for(var r={},n=(t=void 0!==t?t:4e3,d3.scale.threshold().domain([1,3,10,20,30]).range([300,.2*t,.5*t,.7*t,.85*t,t])),a=e.graph.yearRange,i=a[0];i<=a[1];i++)r[i]=n(e.graph.nodeCountsPerYear[i]);return r},n.yearTickClickEventListener=function(){d3.selectAll(".yearTick").on("click",function(e){var t=this.getAttribute("data-year");d3.selectAll(".node, .link").transition().duration(0),n.egoGraphVis.newDestinationNode(t)})};var a=function(){"ABORT"!==citationvis_data&&(d3.select("#mainDiv").append("p").attr("class","loadingText").text("Loading..."),d3.json(citationvis_data,function(e,t){if(console.log(e),e)throw $(".loadingText").html('There was an error generating the visualization, or else data processing is still in progress. Try reloading the page later, or generating the visualization again. If the problem persists, <a href="mailto:jporteno@uw.edu">contact the administrator</a>.').css({color:"red"}),e;var r=d3.nest().key(function(e){return e.DomainID}).sortValues(d3.descending).rollup(function(e){return e.length}).entries(t.nodes[0].papers);r.sort(function(e,t){return d3.descending(e.values,t.values)}),t.nodes[0].DomainCounts=r,console.log(t);var a=n.default_options,i=n.summaryStatistics,o=n.egoGraphData,s=n.lineChartData,l=(n.eventListeners,a.defaults);console.log(l),t=i.addSummaryStatistics(t),n.graph_data=o.prepare_egoGraphData(t),n.publications_data=s.prepareData_egoAuthorPublications(t),n.all_citations_data=s.prepareData_allCitations(t),n.eigenfactor_sum_data=s.prepareData_authorEigenfactorSum(t),n.egoGraphVis=new egoGraphVis(n.graph_data),n.lineCharts=[],n.lineCharts.push(new lineChartByYear(n.publications_data)),n.lineCharts.push(new lineChartByYear(n.all_citations_data)),n.lineCharts.push(new lineChartByYear(n.eigenfactor_sum_data)),l.transitionTimePerYear=n.getTransitionTimePerYear(t),n.egoGraphVis.importDefaultOptions(l);for(var u=0;u<n.lineCharts.length;u++)n.lineCharts[u].importDefaultOptions(l);for(n.egoGraphVis.init(),u=0;u<n.lineCharts.length;u++)n.lineCharts[u].init();$.event.trigger({type:"initComplete"}),n.lineCharts[0].addTitle("Number of publications"),n.lineCharts[1].addTitle("Number of citations received");var c=function(e){for(var t=window.location.search.substring(1).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");if(n[0]==e)return n[1]}return!1}("ctrtype");c||(c="author"),console.log(c),n.lineCharts[2].addTitle("Sum of eigenfactor for this "+c+"'s publications by year"),$(document).on("yearChange",function(){for(var e=n.egoGraphVis.currYear,t=0;t<n.lineCharts.length;t++)n.lineCharts[t].moveYearIndicator(e)}),d3.select(n.lineCharts[0].chartDiv[0][0]).select(".y.axis").select(".axisLabel").text("Num publications"),n.lineCharts[2].yAxis.tickFormat(d3.format("e")),d3.select(n.lineCharts[2].chartDiv[0][0]).select(".y.axis").call(n.lineCharts[2].yAxis).select(".axisLabel").text("Sum of Eigenfactor"),n.yearTickClickEventListener(),d3.select(".loadingText").remove()}))};r.d(t,"main",function(){return a})}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXV0aWx1c192aXMvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL25hdXRpbHVzX3Zpcy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9uYXV0aWx1c192aXMvLi9zcmMvY2l0YXRpb25WaXNfTWFpbi5qcyIsIndlYnBhY2s6Ly9uYXV0aWx1c192aXMvLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiY2l0YXRpb25WaXMiLCJnZXRUcmFuc2l0aW9uVGltZVBlclllYXIiLCJncmFwaCIsImxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUiLCJjb25zb2xlIiwibG9nIiwidHJhbnNpdGlvblRpbWVQZXJZZWFyIiwidGhyZXNob2xkU2NhbGUiLCJkMyIsInNjYWxlIiwidGhyZXNob2xkIiwiZG9tYWluIiwicmFuZ2UiLCJ5ZWFyUmFuZ2UiLCJub2RlQ291bnRzUGVyWWVhciIsInllYXJUaWNrQ2xpY2tFdmVudExpc3RlbmVyIiwic2VsZWN0QWxsIiwib24iLCJkZXN0aW5hdGlvblllYXIiLCJnZXRBdHRyaWJ1dGUiLCJ0cmFuc2l0aW9uIiwiZHVyYXRpb24iLCJlZ29HcmFwaFZpcyIsIm5ld0Rlc3RpbmF0aW9uTm9kZSIsIm1haW4iLCJjaXRhdGlvbnZpc19kYXRhIiwic2VsZWN0IiwiYXBwZW5kIiwiYXR0ciIsInRleHQiLCJqc29uIiwiZXJyb3IiLCIkIiwiaHRtbCIsImNzcyIsImNvbG9yIiwiZG9tYWluc05lc3QiLCJuZXN0IiwiRG9tYWluSUQiLCJzb3J0VmFsdWVzIiwiZGVzY2VuZGluZyIsInJvbGx1cCIsImxlYXZlcyIsImxlbmd0aCIsImVudHJpZXMiLCJub2RlcyIsInBhcGVycyIsInNvcnQiLCJhIiwiYiIsInZhbHVlcyIsIkRvbWFpbkNvdW50cyIsImRlZmF1bHRfb3B0aW9ucyIsInN1bW1hcnlTdGF0aXN0aWNzIiwiZWdvR3JhcGhEYXRhIiwibGluZUNoYXJ0RGF0YSIsIm9wdGlvbnMiLCJldmVudExpc3RlbmVycyIsImRlZmF1bHRzIiwiYWRkU3VtbWFyeVN0YXRpc3RpY3MiLCJncmFwaF9kYXRhIiwicHJlcGFyZV9lZ29HcmFwaERhdGEiLCJwdWJsaWNhdGlvbnNfZGF0YSIsInByZXBhcmVEYXRhX2Vnb0F1dGhvclB1YmxpY2F0aW9ucyIsImFsbF9jaXRhdGlvbnNfZGF0YSIsInByZXBhcmVEYXRhX2FsbENpdGF0aW9ucyIsImVpZ2VuZmFjdG9yX3N1bV9kYXRhIiwicHJlcGFyZURhdGFfYXV0aG9yRWlnZW5mYWN0b3JTdW0iLCJsaW5lQ2hhcnRzIiwicHVzaCIsImxpbmVDaGFydEJ5WWVhciIsImltcG9ydERlZmF1bHRPcHRpb25zIiwiaW5pdCIsImV2ZW50IiwidHJpZ2dlciIsInR5cGUiLCJhZGRUaXRsZSIsImN0cnR5cGUiLCJ2YXJpYWJsZSIsInZhcnMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0cmluZyIsInNwbGl0IiwicGFpciIsImdldFF1ZXJ5VmFyaWFibGUiLCJkb2N1bWVudCIsImN1cnJZZWFyIiwibW92ZVllYXJJbmRpY2F0b3IiLCJjaGFydERpdiIsInlBeGlzIiwidGlja0Zvcm1hdCIsImZv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RUFBVSwyQkFHOUU3QyxFQUFHdUQsVUFBV3RFLEdBQUksYUFBYyxXQUUvQixJQURBLElBQUl1RSxFQUFXeEYsRUFBWXNCLFlBQVlrRSxTQUM5QnhILEVBQUUsRUFBR0EsRUFBRWdDLEVBQVlvRSxXQUFXekIsT0FBUTNFLElBQzlDZ0MsRUFBWW9FLFdBQVdwRyxHQUFHeUgsa0JBQWtCRCxLQU1uQ2hGLEdBQUdrQixPQUFPMUIsRUFBWW9FLFdBQVcsR0FBR3NCLFNBQVMsR0FBRyxJQUNsQ2hFLE9BQU8sV0FBV0EsT0FBTyxjQUNwQ0csS0FBSyxvQkFHbkI3QixFQUFZb0UsV0FBVyxHQUFHdUIsTUFBTUMsV0FBV3BGLEdBQUdxRixPQUFPLE1BRXZDckYsR0FBR2tCLE9BQU8xQixFQUFZb0UsV0FBVyxHQUFHc0IsU0FBUyxHQUFHLElBQ3REaEUsT0FBTyxXQUVidkQsS0FBSzZCLEVBQVlvRSxXQUFXLEdBQUd1QixPQUMvQmpFLE9BQU8sY0FBY0csS0FBSyxzQkFLNUI3QixFQUFZZSw2QkFFWlAsR0FBR2tCLE9BQU8sZ0JBQWdCb0UsYUMzSzNCaEksRUFBQVEsRUFBQXlILEVBQUEseUJBQUFDIiwiZmlsZSI6Im5hdXRpbHVzX3Zpcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcIm5hdXRpbHVzX3Zpc1wiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJuYXV0aWx1c192aXNcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wibmF1dGlsdXNfdmlzXCJdID0gZmFjdG9yeSgpO1xufSkodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsIi8vIGh0dHBzOi8vY3NzLXRyaWNrcy5jb20vc25pcHBldHMvamF2YXNjcmlwdC9nZXQtdXJsLXZhcmlhYmxlcy9cbmZ1bmN0aW9uIGdldFF1ZXJ5VmFyaWFibGUodmFyaWFibGUpXG57XG4gICAgdmFyIHF1ZXJ5ID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSk7XG4gICAgdmFyIHZhcnMgPSBxdWVyeS5zcGxpdChcIiZcIik7XG4gICAgZm9yICh2YXIgaT0wOyBpPHZhcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgaWYocGFpclswXSA9PSB2YXJpYWJsZSkge3JldHVybiBwYWlyWzFdO31cbiAgICB9XG4gICAgcmV0dXJuKGZhbHNlKTtcbn1cblxuXG4vLyBjaXRhdGlvbnZpc19kYXRhIGlzIGEgdmFyaWFibGUgZGVmaW5lZCBpbiB0aGUgZmxhc2sgdGVtcGxhdGUgdGhhdCBpbmNsdWRlcyB0aGlzIGpzIGZpbGUgKGUuZy4gdmlzbWFpbi5odG1sKVxuXG52YXIgY2l0YXRpb25WaXMgPSBjaXRhdGlvblZpcyB8fCB7fTtcblxuY2l0YXRpb25WaXMuZ2V0VHJhbnNpdGlvblRpbWVQZXJZZWFyPSBmdW5jdGlvbihncmFwaCwgbG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSkge1xuXHRjb25zb2xlLmxvZyhncmFwaCk7XG5cdC8vIFRoaXMgd2lsbCBsZXQgdXMgdmFyeSB0aGUgdHJhbnNpdGlvbiB0aW1lIHBlciB5ZWFyXG5cdHZhciB0cmFuc2l0aW9uVGltZVBlclllYXIgPSB7fTtcblx0dmFyIGVtcHR5WWVhclRyYW5zaXRpb25UaW1lID0gMzAwO1xuXHQvLyB2YXIgbG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSA9IDQwMDA7XG5cdC8vIFNldCBkZWZhdWx0IHZhbHVlOlxuXHQvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg5NDg2MC9zZXQtYS1kZWZhdWx0LXBhcmFtZXRlci12YWx1ZS1mb3ItYS1qYXZhc2NyaXB0LWZ1bmN0aW9uXG5cdHZhciBsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lID0gdHlwZW9mIGxvbmdlc3RZZWFyVHJhbnNpdGlvblRpbWUgIT09ICd1bmRlZmluZWQnID8gbG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSA6IDQwMDA7XG5cdC8vIFRoaXMgc2NhbGUgdGFrZXMgdGhlIG51bWJlciBvZiBub2RlcyBmb3IgYSBnaXZlbiB5ZWFyIGFzIGlucHV0XG5cdC8vIGFuZCBvdXRwdXRzIHRoZSB0cmFuc2l0aW9uIHRpbWUsIGJhc2VkIG9uIGEgdGhyZXNob2xkIG1hcHBpbmdcblx0dmFyIHRocmVzaG9sZFNjYWxlID0gZDMuc2NhbGUudGhyZXNob2xkKClcblx0XHQuZG9tYWluKFsxLCAzLCAxMCwgMjAsIDMwXSlcblx0XHQucmFuZ2UoW1xuXHRcdFx0XHRlbXB0eVllYXJUcmFuc2l0aW9uVGltZSwgIC8vIHplcm8gbm9kZXNcblx0XHRcdFx0bG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSAqIC4yLCAgLy8gb25lIG9yIHR3byBub2Rlc1xuXHRcdFx0XHRsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lICogLjUsIC8vIDMgdG8gOVxuXHRcdFx0XHRsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lICogLjcsICAvLyAxMCB0byAxOVxuXHRcdFx0XHRsb25nZXN0WWVhclRyYW5zaXRpb25UaW1lICogLjg1LCAgLy8gMjAgdG8gMjlcblx0XHRcdFx0bG9uZ2VzdFllYXJUcmFuc2l0aW9uVGltZSAgLy8gMzArXG5cdFx0XHRcdF0pO1xuXHR2YXIgeWVhclJhbmdlID0gZ3JhcGguZ3JhcGgueWVhclJhbmdlO1xuXHRcblx0Ly8gUHV0IHRoZSB0cmFuc2l0aW9uIHRpbWUgZm9yIGVhY2ggeWVhciBpbnRvIGFuIG9iamVjdFxuXHRmb3IgKHZhciBpPXllYXJSYW5nZVswXTsgaTw9eWVhclJhbmdlWzFdOyBpKyspIHtcblx0XHQvLyB0cmFuc2l0aW9uVGltZVBlclllYXJbaV0gPSAxMDAwO1xuXHRcdHRyYW5zaXRpb25UaW1lUGVyWWVhcltpXSA9IHRocmVzaG9sZFNjYWxlKGdyYXBoLmdyYXBoLm5vZGVDb3VudHNQZXJZZWFyW2ldKTtcblx0fVxuXHRyZXR1cm4gdHJhbnNpdGlvblRpbWVQZXJZZWFyO1xufTtcblxuY2l0YXRpb25WaXMueWVhclRpY2tDbGlja0V2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBBZGQgY2xpY2sgbGlzdGVuZXJzIHRvIGxpbmUgY2hhcnQgYXhpcyB0aWNrIGxhYmVscyAoeWVhcnMpLlxuICAgIC8vIE9uIGNsaWNrLCBhIG5ldyBkZXN0aW5hdGlvbiBub2RlIHdpbGwgYmUgc2V0LlxuICAgIGQzLnNlbGVjdEFsbCgnLnllYXJUaWNrJylcbiAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIC8vIEdldCB0aGUgeWVhciAoYXMgaW50ZWdlcilcbiAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvblllYXIgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS15ZWFyJyk7XG4gICAgICAgICAgICAvLyBTdG9wIGFsbCB0cmFuc2l0aW9ucyBvbiBub2RlcyBhbmQgbGlua3NcbiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLm5vZGUsIC5saW5rJykudHJhbnNpdGlvbigpLmR1cmF0aW9uKDApO1xuXG5cdFx0XHRjaXRhdGlvblZpcy5lZ29HcmFwaFZpcy5uZXdEZXN0aW5hdGlvbk5vZGUoZGVzdGluYXRpb25ZZWFyKTtcbiAgICAgICAgfSk7XG59O1xuXG5mdW5jdGlvbiBtYWluKCkge1xuXG5pZiAoY2l0YXRpb252aXNfZGF0YSA9PT0gJ0FCT1JUJykge1xuXHRyZXR1cm47XG59XG5cbmQzLnNlbGVjdCgnI21haW5EaXYnKS5hcHBlbmQoJ3AnKVxuXHQuYXR0cihcImNsYXNzXCIsIFwibG9hZGluZ1RleHRcIilcblx0LnRleHQoJ0xvYWRpbmcuLi4nKTtcblxuZDMuanNvbihjaXRhdGlvbnZpc19kYXRhLCBmdW5jdGlvbihlcnJvciwgZ3JhcGgpIHtcblx0Y29uc29sZS5sb2coZXJyb3IpO1xuXHRpZiAoZXJyb3IpIHtcblx0XHR2YXIgY29udGFjdEVtYWlsID0gJ2pwb3J0ZW5vQHV3LmVkdSc7XG5cdFx0dmFyIGVyckh0bWwgPSAnVGhlcmUgd2FzIGFuIGVycm9yIGdlbmVyYXRpbmcgdGhlIHZpc3VhbGl6YXRpb24sIG9yIGVsc2UgZGF0YSBwcm9jZXNzaW5nIGlzIHN0aWxsIGluIHByb2dyZXNzLiBUcnkgcmVsb2FkaW5nIHRoZSBwYWdlIGxhdGVyLCBvciBnZW5lcmF0aW5nIHRoZSB2aXN1YWxpemF0aW9uIGFnYWluLiBJZiB0aGUgcHJvYmxlbSBwZXJzaXN0cywgPGEgaHJlZj1cIm1haWx0bzonICsgY29udGFjdEVtYWlsICsgJ1wiPmNvbnRhY3QgdGhlIGFkbWluaXN0cmF0b3I8L2E+Lidcblx0XHQkKCAnLmxvYWRpbmdUZXh0JyApLmh0bWwoIGVyckh0bWwgKVxuXHRcdFx0LmNzcyggeydjb2xvcic6ICdyZWQnfSApO1xuXHRcdHRocm93IGVycm9yO1xuXHR9XG5cblx0Ly8gR2V0IHRoZSBtb3N0IGNvbW1vbiBEb21haW4gSURzIGZvciB0aGUgZWdvIGF1dGhvcidzIHBhcGVyc1xuXHR2YXIgZG9tYWluc05lc3QgPSBkMy5uZXN0KClcblx0XHQua2V5KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQuRG9tYWluSUQ7IH0pLnNvcnRWYWx1ZXMoZDMuZGVzY2VuZGluZylcblx0XHQucm9sbHVwKGZ1bmN0aW9uKGxlYXZlcykgeyByZXR1cm4gbGVhdmVzLmxlbmd0aDsgfSlcblx0XHQuZW50cmllcyhncmFwaC5ub2Rlc1swXS5wYXBlcnMpO1xuXHRkb21haW5zTmVzdC5zb3J0KGZ1bmN0aW9uKGEsYikgeyByZXR1cm4gZDMuZGVzY2VuZGluZyhhLnZhbHVlcywgYi52YWx1ZXMpOyB9KTtcblx0Ly8gc3RvcmUgYXMgYSBub2RlIHByb3BlcnR5XG5cdGdyYXBoLm5vZGVzWzBdLkRvbWFpbkNvdW50cyA9IGRvbWFpbnNOZXN0O1xuXHRjb25zb2xlLmxvZyhncmFwaCk7XG5cdC8vIGQzLnNlbGVjdCgnI2luZm9EaXYnKS5hcHBlbmQoJ3AnKS50ZXh0KGdyYXBoLm5vZGVzWzBdLkF1dGhvck5hbWUpO1xuXG5cdHZhciBkZWZhdWx0X29wdGlvbnMgPSBjaXRhdGlvblZpcy5kZWZhdWx0X29wdGlvbnMsIFxuXHRcdHN1bW1hcnlTdGF0aXN0aWNzID0gY2l0YXRpb25WaXMuc3VtbWFyeVN0YXRpc3RpY3MsXG5cdFx0ZWdvR3JhcGhEYXRhID0gY2l0YXRpb25WaXMuZWdvR3JhcGhEYXRhLFxuXHQgICAgbGluZUNoYXJ0RGF0YSA9IGNpdGF0aW9uVmlzLmxpbmVDaGFydERhdGEsXG5cdFx0ZXZlbnRMaXN0ZW5lcnMgPSBjaXRhdGlvblZpcy5ldmVudExpc3RlbmVycztcblxuXHR2YXIgb3B0aW9ucyA9IGRlZmF1bHRfb3B0aW9ucy5kZWZhdWx0cztcblx0Y29uc29sZS5sb2cob3B0aW9ucyk7XG5cblx0Z3JhcGggPSBzdW1tYXJ5U3RhdGlzdGljcy5hZGRTdW1tYXJ5U3RhdGlzdGljcyhncmFwaCk7XG5cdGNpdGF0aW9uVmlzLmdyYXBoX2RhdGEgPSBlZ29HcmFwaERhdGEucHJlcGFyZV9lZ29HcmFwaERhdGEoZ3JhcGgpO1xuXHRjaXRhdGlvblZpcy5wdWJsaWNhdGlvbnNfZGF0YSA9IGxpbmVDaGFydERhdGEucHJlcGFyZURhdGFfZWdvQXV0aG9yUHVibGljYXRpb25zKGdyYXBoKTtcblx0Y2l0YXRpb25WaXMuYWxsX2NpdGF0aW9uc19kYXRhID0gbGluZUNoYXJ0RGF0YS5wcmVwYXJlRGF0YV9hbGxDaXRhdGlvbnMoZ3JhcGgpO1xuXHRjaXRhdGlvblZpcy5laWdlbmZhY3Rvcl9zdW1fZGF0YSA9IGxpbmVDaGFydERhdGEucHJlcGFyZURhdGFfYXV0aG9yRWlnZW5mYWN0b3JTdW0oZ3JhcGgpO1xuXG5cdC8vIFZpc3VhbGl6YXRpb24gb2JqZWN0cyBnbyBoZXJlXG5cdGNpdGF0aW9uVmlzLmVnb0dyYXBoVmlzID0gbmV3IGVnb0dyYXBoVmlzKGNpdGF0aW9uVmlzLmdyYXBoX2RhdGEpO1xuXHQvLyBjaXRhdGlvblZpcy5wdWJsaWNhdGlvbnNMaW5lQ2hhcnQgPSBuZXcgbGluZUNoYXJ0QnlZZWFyKGNpdGF0aW9uVmlzLnB1YmxpY2F0aW9uc19kYXRhKTtcblx0Ly8gY2l0YXRpb25WaXMuY2l0YXRpb25zTGluZUNoYXJ0ID0gbmV3IGxpbmVDaGFydEJ5WWVhcihjaXRhdGlvblZpcy5hbGxfY2l0YXRpb25zX2RhdGEpO1xuXHQvLyBjaXRhdGlvblZpcy5laWdlbmZhY3RvclN1bUxpbmVDaGFydCA9IG5ldyBsaW5lQ2hhcnRCeVllYXIoY2l0YXRpb25WaXMuZWlnZW5mYWN0b3Jfc3VtX2RhdGEpO1xuXHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzID0gW107XG5cdGNpdGF0aW9uVmlzLmxpbmVDaGFydHMucHVzaChuZXcgbGluZUNoYXJ0QnlZZWFyKGNpdGF0aW9uVmlzLnB1YmxpY2F0aW9uc19kYXRhKSk7XG5cdGNpdGF0aW9uVmlzLmxpbmVDaGFydHMucHVzaChuZXcgbGluZUNoYXJ0QnlZZWFyKGNpdGF0aW9uVmlzLmFsbF9jaXRhdGlvbnNfZGF0YSkpO1xuXHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzLnB1c2gobmV3IGxpbmVDaGFydEJ5WWVhcihjaXRhdGlvblZpcy5laWdlbmZhY3Rvcl9zdW1fZGF0YSkpO1xuXG5cdG9wdGlvbnMudHJhbnNpdGlvblRpbWVQZXJZZWFyID0gY2l0YXRpb25WaXMuZ2V0VHJhbnNpdGlvblRpbWVQZXJZZWFyKGdyYXBoKTtcblxuXHRjaXRhdGlvblZpcy5lZ29HcmFwaFZpcy5pbXBvcnREZWZhdWx0T3B0aW9ucyhvcHRpb25zKTtcblx0Zm9yICh2YXIgaT0wOyBpPGNpdGF0aW9uVmlzLmxpbmVDaGFydHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzW2ldLmltcG9ydERlZmF1bHRPcHRpb25zKG9wdGlvbnMpO1xuXHR9XG5cblx0Y2l0YXRpb25WaXMuZWdvR3JhcGhWaXMuaW5pdCgpO1xuXHRmb3IgKHZhciBpPTA7IGk8Y2l0YXRpb25WaXMubGluZUNoYXJ0cy5sZW5ndGg7IGkrKykge1xuXHRcdGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbaV0uaW5pdCgpO1xuXHR9XG5cdCQuZXZlbnQudHJpZ2dlcih7XG5cdFx0dHlwZTogXCJpbml0Q29tcGxldGVcIixcblx0fSk7XG5cblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0c1swXS5hZGRUaXRsZShcIk51bWJlciBvZiBwdWJsaWNhdGlvbnNcIik7XG5cdGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbMV0uYWRkVGl0bGUoXCJOdW1iZXIgb2YgY2l0YXRpb25zIHJlY2VpdmVkXCIpO1xuXHR2YXIgY3RydHlwZSA9IGdldFF1ZXJ5VmFyaWFibGUoXCJjdHJ0eXBlXCIpO1xuXHRpZiAoIWN0cnR5cGUpIHtcblx0XHRjdHJ0eXBlID0gXCJhdXRob3JcIjtcblx0fVxuXHRjb25zb2xlLmxvZyhjdHJ0eXBlKTtcblx0Ly8gY2l0YXRpb25WaXMubGluZUNoYXJ0c1syXS5hZGRUaXRsZShcIlN1bSBvZiBlaWdlbmZhY3RvciBmb3IgdGhpcyBhdXRob3IncyBwdWJsaWNhdGlvbnMgYnkgeWVhclwiKTtcblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0c1syXS5hZGRUaXRsZShcIlN1bSBvZiBlaWdlbmZhY3RvciBmb3IgdGhpcyBcIiArIGN0cnR5cGUgKyBcIidzIHB1YmxpY2F0aW9ucyBieSB5ZWFyXCIpO1xuXG5cblx0JCggZG9jdW1lbnQgKS5vbiggXCJ5ZWFyQ2hhbmdlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjdXJyWWVhciA9IGNpdGF0aW9uVmlzLmVnb0dyYXBoVmlzLmN1cnJZZWFyO1xuXHRcdGZvciAodmFyIGk9MDsgaTxjaXRhdGlvblZpcy5saW5lQ2hhcnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRjaXRhdGlvblZpcy5saW5lQ2hhcnRzW2ldLm1vdmVZZWFySW5kaWNhdG9yKGN1cnJZZWFyKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIEhhY2sgdG8gbGFiZWwgdGhlIHB1YmxpY2F0aW9ucyBsaW5lIGNoYXJ0LiBUT0RPOiBGaXggdGhpcyBsYXRlclxuXHQvLyB2YXIgcHVicyA9IGQzLnNlbGVjdChjaXRhdGlvblZpcy5wdWJsaWNhdGlvbnNMaW5lQ2hhcnQuY2hhcnREaXZbMF1bMF0pO1xuXHR2YXIgcHVicyA9IGQzLnNlbGVjdChjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzBdLmNoYXJ0RGl2WzBdWzBdKTtcblx0dmFyIHB1YnNBeGlzTGFiZWwgPSBwdWJzLnNlbGVjdCgnLnkuYXhpcycpLnNlbGVjdCgnLmF4aXNMYWJlbCcpO1xuXHRwdWJzQXhpc0xhYmVsLnRleHQoJ051bSBwdWJsaWNhdGlvbnMnKTtcblx0Ly8gSGFjayB0byBhbHRlciBlaWdlbmZhY3RvciBsaW5lIGNoYXJ0LiBUT0RPOiBGaXggdGhpcyBsYXRlclxuXHQvLyBjaXRhdGlvblZpcy5laWdlbmZhY3RvclN1bUxpbmVDaGFydC55QXhpcy50aWNrRm9ybWF0KGQzLmZvcm1hdCgnZScpKTtcblx0Y2l0YXRpb25WaXMubGluZUNoYXJ0c1syXS55QXhpcy50aWNrRm9ybWF0KGQzLmZvcm1hdCgnZScpKTtcblx0Ly8gdmFyIEVGQ2hhcnQgPSBkMy5zZWxlY3QoY2l0YXRpb25WaXMuZWlnZW5mYWN0b3JTdW1MaW5lQ2hhcnQuY2hhcnREaXZbMF1bMF0pO1xuXHR2YXIgRUZDaGFydCA9IGQzLnNlbGVjdChjaXRhdGlvblZpcy5saW5lQ2hhcnRzWzJdLmNoYXJ0RGl2WzBdWzBdKTtcblx0RUZDaGFydC5zZWxlY3QoJy55LmF4aXMnKVxuXHRcdC8vIC5jYWxsKGNpdGF0aW9uVmlzLmVpZ2VuZmFjdG9yU3VtTGluZUNoYXJ0LnlBeGlzKVxuXHRcdC5jYWxsKGNpdGF0aW9uVmlzLmxpbmVDaGFydHNbMl0ueUF4aXMpXG5cdFx0LnNlbGVjdCgnLmF4aXNMYWJlbCcpLnRleHQoJ1N1bSBvZiBFaWdlbmZhY3RvcicpO1xuXG5cblx0Ly8gRXZlbnQgbGlzdGVuZXJzXG5cdC8vIEV2ZW50IGxpc3RlbmVycyB0aGF0IGFjdCBhY3Jvc3MgZGlmZmVyZW50IHZpc3VhbGl6YXRpb24gb2JqZWN0cyBnbyBoZXJlXG5cdGNpdGF0aW9uVmlzLnllYXJUaWNrQ2xpY2tFdmVudExpc3RlbmVyKCk7XG5cdFxuXHRkMy5zZWxlY3QoXCIubG9hZGluZ1RleHRcIikucmVtb3ZlKCk7XG59KTtcbi8vIH0pKGNpdGF0aW9udmlzX2RhdGEpO1xufVxuXG4vLyBtYWluKCk7XG4vL1xuZXhwb3J0IGRlZmF1bHQgbWFpbjtcbiIsImltcG9ydCBtYWluIGZyb20gJy4vY2l0YXRpb25WaXNfTWFpbi5qcyc7XG5leHBvcnQgeyBtYWluIH07XG5cbiJdLCJzb3VyY2VSb290IjoiIn0=